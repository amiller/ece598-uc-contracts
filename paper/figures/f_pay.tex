\begin{bbox}[title={$\Fpay (P_L,P_R,\Delta)$}]

Initialize $\msf{bal_L} := 0, \msf{bal_R} := 0$

\OnInput \inmsg{pay}{\$X} from \Partyi:

	\quad \If $\msf{bal}_i < \$X$: ignore  

	\quad \Leak $(\msf{pay},P_i,\$X) \rightarrow \mathcal{A}$

	\quad $\msf{bal}_i -= \$X$

	\quad \If $P_{\neg i}$ is honest: \Buffer $((\msf{receive},\$X),1,P_{\neg i})$

	\quad \Else: \Buffer $((\msf{receive},\$X),O(\Delta),P_{\neg i})$ 

\OnInput \inmsg{withdraw}{\$X} from \Partyi:

	\quad \If $\msf{bal}_i < \$X$: ignore

	\quad \Leak $(\msf{withdraw},P_i,\$X) \rightarrow \mathcal{A}$

	\quad $\msf{bal}_i -= \$X$

	\quad \Send $(\msf{transfer}, (\mathbf{sid},\mathbf{pid}), \$X, \bot, \msf{mysidsomehow}) \rightarrow \Gledger$

\OnInput \inmsg{deliver}{msg,$P_i$}:

	\quad \If $(\msf{receive},e) = msg$:

		\qquad $\msf{bal}_i += \$X$
	

\end{bbox}
