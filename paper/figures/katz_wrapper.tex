\begin{bbox}[title={\textbf{Wrapper} $\mathcal{W}_{\msf{katz}} ( \pi )$}]

Initialize $\msf{todo} := \emptyset, t := 0, \msf{output} := \bot, \msf{ready} := 0, \msf{round} := 1$

\vspace{2mm} \hrule \vspace{2mm}

-- \OnInput \inmsg{input}{$x$} from $p_i$:  Forward \inmsg{input}{$x$} to $\pi$

-- \OnInput \inmsg{output} from $\mathcal{Z}$

	\qquad \If $t > 0$: Set $t = t-1$  If $\msf{todo} \neq \emptyset$:

		\qqquad Pop $(pid, msg) \leftarrow \msf{todo}$ and execute \Send $(msg) \rightarrow \Fbdsec$ where $j = pid$ and $i$ is the pid of $\pi$.

	\qquad \Else \If $t == 0$: Set $t = t-1$ and \Send $(\texttt{RoundOK}) \rightarrow \Fclock$

	\qquad \Else:
	
		\qqquad \If $\msf{ready}$: \Output \msf{output}

		\qqquad \Else \Output $(\texttt{early})$

\vspace{2mm} \hrule \vspace{2mm}

-- \OnInput \inmsg{Send}{pid}{msg} from $\pi$:

	\qquad Append $(pid, msg)$ to $\msf{todo}$

\end{bbox}
