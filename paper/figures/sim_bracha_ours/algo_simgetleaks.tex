\begin{bbox}[title={Algorithm $\msf{SimGetLeaks}$}]

$leaks \leftarrow$ \{ \Send (\texttt{get-leaks}) $\rightarrow \mathcal{\mathcal{A}'}$ \}

$n \leftarrow \#$ of (schedule,...) messages in $leaks$

$idealdelay = idealdelay + n$

If $idealdelay = n$:

	\quad $idealdelay = idealdelay + 1$

	\quad \{ \Send (delay, $n+1 \token$) $\rightarrow \mathcal{W}_{sync}$ \}

\Else:

	\quad \{ \Send (delay $n \token$) $\rightarrow \mathcal{W}_{sync}$ \}

\Return $leaks$

\end{bbox}


