\begin{bbox}[title={\textbf{Functionality} $\F_{\msf{BD-SEC}}^{\delta,\ell}(p_s,p_r)$}]

Initialize $M := \bot$ and $D := 1$ and $\hat{D} := 1$

-- \OnInput \inmsg{m} from $\mathbf{p_s}$:

	\dquad Set $D := 1$, $M := m$

	\dquad \Leak ({\bf send},$M$) $\rightarrow \mathcal{A}$

-- \OnInput \inmsg{fetch} from $p_r$:

	\dquad Set $D = D - 1$

	\dquad \If $D = 0$: \Send ({\bf sent},$M$) $\rightarrow p_r$

-- \OnInput \inmsg{delay}{T} from $\mathcal{A}$:

	\qquad \If $\hat{D} + T \leq \delta$: 

		\qquad \quad $D := D + T$, $\hat{D} := \hat{D} + T$

		\qquad \quad \Send ({\bf delay},$T$) $\rightarrow \mathcal{A}$

-- \OnInput \inmsg{replace}{$m'$}{$T'$} from $\mathcal{A}$:

	\qquad \If $p_s$ corrupted, $D > 0$ and $T'$ is valid:

		\qquad \quad $D := T'$ and $M' = m$
\end{bbox}

